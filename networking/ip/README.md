# Протокол IP

**Среда выполнения**: две отдельные виртуальные машины (VirtualBox), выбранная операционная система - Ubuntu Server.

## Часть 1. IP адресация

Установим User A данный адрес (10.123.0.23 с маской сети 255.255.255.0).

```bash
sudo ip address change 10.123.0.23/24 dev tap0
```

Для User B также установим с такой же маской данный адрес (10.123.0.24).

```bash
sudo ip address change 10.123.0.24/24 dev tap0
```

Можем делать ping'и, так как данные адреса находятся в одном диапазоне сети 10.123.0.0. В случае второго примера адреса находятся в разных подсетях, а значит, без какой-либо иной помощи внешне, не смогут достучаться до другу друга. Тоже самое касается и двух примеров с парами: проверяем по диапазону.

## Часть 2. IPv4

Установим User A данный адрес (10.210.126.152).

```bash
sudo ip address change 10.210.126.152/24 dev tap0
```

И выполним с User A пинг по адресу 10.210.126.19.

```bash
ping 10.210.126.19
```

Для того, чтобы узнать MAC адрес воспользуемся утилитой `arp` из пакета `net-tools`: выведется таблица, где нас интересуют две колонки "Address" и "HWaddress" - ищем в "Address" только что ping'нутый адрес и берём вторую интересуемую колонку.

## Часть 3. IPv6

Для того, чтобы расширить MAC адрес до 64 бит воспользуемся следующим алгоритмом преобразования:

1. Поделим 48 бит на две части по 24 бит.
2. Выпишем первую часть.
3. Впишем после значения 256 и 254.
4. Выпишем оставшуюся часть.
5. Начиная с самого крайнего инвертируем 6-ой бит, нумеруя с нуля.
6. Переведем в десятичное число и добавим префикс `fe80:`.

Получаем по итогу link-local адрес.

Сделаем ping на узел. Установим User A данный адрес:

```bash
sudo ip address change fd33:c72f:ebb4:2705:f142:ea0f:8487:cf09/64 dev tap0
```

Свершим ping по данному адресу:

```bash
ping6 fd33:c72f:ebb4:2705:4cf1:c4c4:6b14:4bf4
```

Получим MAC адрес, исследовав таблицу команды `ip neighbour`: найдем там адрес ранее ping'нутый, там и будет нужный MAC адрес.

## Часть 4. MTU

Чтобы послать пакет определенного размера под данные используется флаг `-s <NUMBER OF BYTES>`. Начнем искать размер, согласившись на границы 0 и 1280 байт (т. к. случайно взятое значение больше не давал отклика). Получим 997 байт. Но для отправки нужно ещё 48 байт (на ответ и на заголовок данных).
