# DHCP-клиент

**Среда выполнения**: две виртуальные машины (VirtualBox), выбранные операционные системы - Ubuntu Server и Ubuntu Desktop.

## Часть 1. IPv4

Адрес был получен слегка странным методом: путем просмотра системных логов.

```bash
cat /var/log/syslog | grep "DHCP"
```

Там было что-то вроде такого:

```bash
DHCPACK of 10.109.66.25 from 10.109.66.254
DHCPREQUEST 10.109.66.25 on tap0 to 10.109.66.254
```

Затем была прочтена документация к утилите `dhclient` и в файле `/var/lib/dhcp/dhclient.leases` лежала информация о маске (поле `option subnet-mask`).

В том же файле лежала информация и о домене сети (поле `option domain-search`).

## Часть 2. IPv6

Сначала был получен адрес от DHCPv6. Для этого воспользуемся утилитой `dhclient`, но мы должны сказать явно, что мы хотим использовать именно протокол DHCPv6 (то есть, по всем доступным IPv6 адресам) и подать ему имя устройства.

```bash
sudo dhclient -6 tap0
```

Для получения адреса нам нужен префикс и суффикс. Для этого склеим префикс (по маске) и данный суффикс адреса. Посмотрим через команду `ip address show` - найдем там адрес, отрубим столько, сколько занимает префикс и склеим с суффиксом. Затем, воспользуемся командой `ping` с флагом `-6`.

В отличии от SLAAC, который инициализируется каким-то неизвестным адресом (локальный IPv6), DHCP (и DHCPv6) работают по принципу: подать запрос с стороны B (discover), принять ответ с стороны A (offer), отправить ответ с стороны A (request), принять ответ с стороны B (ack) и нужен этот протокол как раз для выдачи IP адресов клиентам. Так и получается, что во второй части этого задания мы послали запрос с стороны клиента, а сервер, спустя ещё несколько запросов, выдал нам адрес, а в первой - пришлось вручную, так как серверу не был известен адрес - мы его попинговали сами.

Теперь попытамся зайти на сайт. Для этого нам нужно найти адрес: воспользуемся утилитой `nslookup`, которая запрашивает информацию о доменных именах, в частности по умолчанию она возвращает IP адрес.

```bash
nslookup 37kvovbuqfkv7sn4prc549n3.localnetwork
```

Теперь поймем, что ни `lynx`, ни `w3m` не отображают сайт нормальным образом (кнопочка превратилась в HTML вставку), а `links`, `links2` и `elinks` вообще отказывались с этим адресом хоть что-то делать, перейдем на другую систему (Desktop версию), проделаем там те же действия и вбъем в браузер данный адрес - и там кликнем на кнопку ("Click me!").
